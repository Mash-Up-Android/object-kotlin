## 1. 협력
영화 예매 시스템을 구성하기 위해 하나의 객체가 아닌 각자의 책임을 갖는 여러 객체가 메시지를 주고받으면서 유기적으로 상호작용 한다는게 핵심

협력 : 메시지, 여러 객체, 상호작용

책임 : 협력에 참여하기 위해 수행해야 하는 로직

역할 : 객체가 협력 안에서 수행하는 책임들

협력 > 역할 > 책임으로 구성되는 것 같음

협력은 메시지 전송이 필수

다른객체의 상세 구현에 직접 접근할 수 없기 때문에 메시지 전송을 통해서만 자신의 요청을 다른 객체에 전달해서 협력할 수 있음

수신한 객체는 메서드를 실행해 요청에 응답함, 메서드는 스스로 선택 (자율적 존재)

객체를 자율적 존재로 두기 위해서는 결국 내부 구현을 캡슐화 해야함

그렇지 않으면 객체가 자신의 상태를 직접 관리하지 못하고 자율성이 훼손될 수 있음, 즉 수동적인 존재가 되게 됨

Movie 객체의 행동?

보통 영화라고 하면 극장에서 영화를 상영하는 장면을 연상하고, 자연스럽게 play 행동을 수행해야 한다

작성된 코드 대부분은 아직 요금을 계산하는 행동과 관련되어 있는데, Movie는 영화를 예매하기 위한 협력에 참여하고 있고 그 안에서 요금을 계산하는 책임을 지고 있는 것

즉, 협력은 객체를 설계하는데 필요한 객체가 가져야할 상태들에 대한 문맥(Context)를 제공하게 됨

## 2. 책임
책임은 객체가 협력에 참여하기 위해 수행하는 행동을 의미

객체에 정의되는 응집도 있는 행위들의 집합이다.

여기서 객체가 유지해야하는 정보와 수행할 수 있는 행동들에 대해 서술한 문장으로 이해할 수 있음
![img.png](../../../../assets/재성/img09.png)

아는 것 : 책임을 수행하기 위한 인스턴스 변수?

하는 것 : 책임을 수행하기 위한 메서드?

책임은 아는것, 하는것과 밀접하게 연관되어있음

객체가 자신이 할 수 없는 행위를 위임하거나 도와줄 객체에 대해 알고있을 책임도 있음

Screening이 reserve라는 메시지를 수신하고 movie를 인스턴스 변수로 갖고 있는 건 영화를 예매할 책임을 수행해야 하기 때문

Movie가 calculateMovieFee 메시지를 수신하고, fee와 DiscountPolicy를 인스턴스 변수로 갖는건 요금을 계산해야하는 책임을 수행해야 하기 때문

즉, 협력 안에서 객체에 할당된 책임이 외부의 인터페이스와 내부 속성을 결정한다

객체지향 설계에서 가장 중요한건 책임이다

객체에 얼마나 적절한 책임을 부여하는지에 따라 전체적인 설계의 품질을 좌우함

책임을 할당하기 위해서는 협력을 어떻게 할지를 정해야 함

영화 예매 시스템에서는 예매하라라는 메세지를 시발점으로 객체들이 협력을 시작함

예매하라라는 메시지를 처리해야할 객체를 선택해야하는데~ 이거에 대한 책임을 질 객체를 어떤걸 선택해야할까

영화 예매와 관련된 정보를 가장 많이 알고있는 객체 (책에서는 정보 전문가?로 표현)에게 할당해야 함 → Screening 객체

예매를 위해 가격을 계산해야하는데 가격 계산에 대한 책임은 Screening의 책임이 아님

즉 다른 객체에 위임하고 계산하기 위한 메세지를 전달해야 하는데 이 객체는 Movie

**Q. 근데 책에서 이야기하는 정보전문가라는 말이 정확히 무슨말인지 이해를 못한듯..?ㅋㅋ**

중요한 점은 객체가 메세지를 선택하는게 아니라 메세지가 객체를 선택하는 것.

이렇게 하려면 최소한의 인터페이스를 가져야 함

무엇을 하는지에 대한 추상적인 인터페이스를 가질 수 있게됨, 어떻게는 어차피 캡슐화됨

객체의 캡슐화를 위반하지 않도록 객체의 행위를 고려하기 위해서는 객체가 참여하는 협력 상의 문맥을 판단하면서 객체를 생각해야 한다. 구현은 일단 후순위

협력 관계 안에서 다른객체로 부터 뭘 받아야할지, 뭘 전달해야할지를 판단하는게 훌륭한 책임을 찾는 방법

이렇게 해야 객체의 응집도를 높이고 결합도를 낮출 수 있음

상태는 단순히 객체가 행동을 정상적으로 수행하기 위한 재료일 뿐

행동이 먼저 정의가 되어야 그에 필요한 상태들을 결정할 수 있다

## 3. 역할
역할은 협력안에서 객체가 수행하는 책임의 집합

역할이 중요한 이유는 역할을 통해 유연하고 재사용 가능한 협력을 얻을 수 있기 때문

역할이 정의되지 않은 상태에서 책임을 할당한다면 아래같은 상황이 만들어질 수 있음
![img.png](../../../../assets/재성/img10.png)
가격 계산 메세지에 응답하기 위해서 요금 계산에 대한 할인 정책들이 있을 텐데 각각을 별개의 협력으로 본다면 중복으로 작성되는 코드가 많아질것임

![img.png](../../../../assets/재성/img11.png)
결국 이렇게 되어야 할인 정책 선택 책임에 대한 역할이 생기게 됨

즉, 역할이 두 정책의 구체적인 객체를 포괄하는 추상화로 볼 수 있음

협력의 관점에서 추상화(인터페이스, 추상클래스)는 구체 클래스들이 따라야하는 책임의 집합을 서술한 것

인터페이스, 추상클래스 선택 기준?

1. 추상클래스 : 구체 클래스들이 공유하는 상태와 행동의 기본 구현이 존재하는 경우
2. 인터페이스 : 공통의 구현은 없지만 책임의 집합만 서술하는 경우

객체 vs 역할?

협력에 참여하는 대상이 여러 종류의 객체에 의해 수행될 필요가 있다?  → 역할

협력에 참여하는 대상이 하나의 객체일 경우 → 객체

![img.png](../../../../assets/재성/img12.png)
설계 초반에는 적절한 책임과 협력의 큰 그림을 탐색하는게 중요한 목표여야 함

역할과 객체를 명확하게 구분하는건 초반에는 그렇게 중요하지 않다네

단순하게 객체로 시작하고 책임과 협력을 계속 정제하면서 적절하게 역할을 분리해내는게 좋음
![img.png](../../../../assets/재성/img13.png)
역할은 공통의 책임을 바탕으로 객체의 종류를 숨기기 때문에 역할도 추상화로 볼 수 있음

구체 객체로 대체 가능한 DiscountPolicy와 DiscountCondition이 역할에 해당함